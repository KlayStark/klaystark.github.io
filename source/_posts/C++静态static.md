---
title: C++静态static
date: 2021-06-30 18:58:04
categories: C++
tags:
---

## static作用：

static修饰于：

1. 文件作用域（.h/.cpp文件中直接修饰变量或函数），意味着这些变量或函数只在本文件中可见，其他文件看不到也无法使用，可以避免重定义的问题。

2. 函数作用域（即作为局部静态变量），意味着这个变量时全局的，只会进行一次初始化，不会随着新的实例而重置，但只在这个函数内可见。

3. 类的声明（即静态数据成员和静态成员函数），意味着这些数据和函数是所有类对象共享的一种属性，而非每个对象独有。


## static变量什么时候初始化？

static变量在类的声明中不占用内存，因此必须在.cpp文件中定义类静态变量以分配内存。

全局变量、文件域的静态变量和类的静态成员变量在main执行之前的静态初始化过程中分配内存并初始化；

局部静态变量在第一次使用时分配内存并初始化。

## 举例

```c++
struct Entity
{
    static int x, y;

    void Print()
    {
        std::cout << x << "," << y << std::endl;
    }
};

int Entity::x;   //静态变量初始化
int Entity::y;
int main()
{
    Entity e;
    e.x = 2;    //我们这里因为是静态变量跟我们的实例e没有关系，可以写成 Entity::x = 2
    e.y = 3;

    Entity e1;
    e1.x = 5;  //我们这里因为是静态变量跟我们的实例e1没有关系，可以写成 Entity::x = 5
    e1.y = 8;

    e.Print();   //这里打印x，y是5和8
    e1.Print(); //这里是打印x，y也是5和8

    return 0;
}
```

## 其他

静态方法不能访问非静态变量和方法。
